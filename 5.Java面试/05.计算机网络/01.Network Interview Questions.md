# 01.Network Interview Questions

![OSI Model: The 7 Layers of Network Architecture – BMC Software | Blogs](https://s7280.pcdn.co/wp-content/uploads/2018/06/osi-model-7-layers-1024x734.jpg)

- Physical 物理层
  - Converts data bit into an electrical impulse.
- Data Link 数据链路层
  - Data packet will be encoded and decoded into bits.
- Network 网络层 (IP)
  - Transfer of datagrams from one to another.
- Transport 运输层 (TCP, UDP)
  - Responsible for Data transfer from one to another.
- Session 会话层 (应用层)
  - Manage and control signals between computers.
- Presentation 表示层 (应用层)
  - Transform data into application layer format.
- Application 应用层 (应用层)
  - An end user will interact with the Application layer.

### 1.1 应用层

- 应用层(application-layer）的任务是通过 **应用进程间的交互** 来完成特定网络应用。
- 应用层协议定义的是 **应用进程**（进程：主机中正在运行的程序）间的 **通信和交互** 的规则。

**HTTP协议**

> 超文本传输协议（HTTP，HyperText Transfer Protocol)是互联网上应用最为广泛的一种网络协议。所有的 WWW（万维网） 文件都必须遵守这个标准。设计 HTTP 最初的目的是为了**提供一种发布和接收 HTML 页面的方法**

### 1.2 运输层

- 运输层(transport layer)的主要任务就是负责向 **两台主机进程之间的通信** 提供 **通用的数据传输服务**
- 复用：多个应用层进程可同时使用 **运输层的服务**
- 分用：运输层把 **收到的信息** 分别交付 **应用层中的相应进程**

#### TCP (Transmission Control Protocol)

- 提供**面向连接**的，**可靠的**数据传输服务。

#### UDP (User Datagram Protocol)

- 提供**无连接**的，尽最大努力的数据传输服务（**不保证数据传输的可靠性**）

### 1.3 网络层

- 网络层的任务就是**选择合适的网间路由**和**交换结点**， 确保数据**及时传送**
- 网络层使用 **IP 协议**，因此分组也叫 **IP 数据报** ，简称 **数据报**。

### 1.4 数据链路层

- 两台主机之间的数据传输，总是在一段一段的链路上传送的，这就需要使用专门的链路层的协议
- **数据链路层将网络层交下来的 IP 数据报组装程帧**，在两个相邻节点间的链路上传送帧。
- 每一帧包括数据和必要的控制信息（如同步信息，地址信息，差错控制等）。
- 控制信息 使接收端能够知道一个帧从 **哪个比特开始** 和到 **哪个比特结束**，在收到一个帧后，就可从中提出**数据部分**，上交给网络层

### 1.5 物理层

- 在物理层上所传送的数据单位是比特。
- 实现相邻计算机节点之间比特流的透明传送，尽可能屏蔽掉具体传输介质和物理设备的差异。

![img](https://images.xiaozhuanlan.com/photo/2019/2057ef65725794622d3d6479a9d300a3.png)

## 二. TCP 三次握手和四次挥手

### 2.1 TCP 三次握手漫画图解

![TCP三次握手](https://images.xiaozhuanlan.com/photo/2019/847a3bf90a740e68d5de4f2622ebd2ba.png)

- 客户端–发送带有 `SYN` 标志的数据包–一次握手–服务端
- 服务端–发送带有 `SYN/ACK` 标志的数据包–二次握手–客户端
- 客户端–发送带有带有 `ACK` 标志的数据包–三次握手–服务端

### 2.2 为什么要三次握手

- Establish Reliable Communication 建立**可靠**的通信信道
- 双方确认自己与对方的 **发送与接收是正常的**

#### 过程

- 第一次握手：Client 什么都不能确认；Server 确认了对方发送正常，自己接收正常
- 第二次握手：Client 确认了：自己发送、接收正常，对方发送、接收正常；Server 确认了：对方发送正常，自己接收正常
- 第三次握手：Client 确认了：自己发送、接收正常，对方发送、接收正常；Server 确认了：**自己发送正常**、自己接收正常，对方发送正常、**对方接收正常**

### 2.3 为什么要传回 SYN

- 接收端传回发送端所发送的 `SYN` 是为了告诉发送端，我接收到的信息确实就是你所发送的信号了。

### 2.4 传了 SYN,为啥还要传 ACK

- 双方通信无误必须是两者互相发送信息都无误。传了 `SYN`，证明**发送方到接收方**的通道没有问题，但是接收方到发送方的通道还需要 `ACK` 信号来进行验证。

### 2.5 为什么要四次挥手

![TCP四次挥手](https://images.xiaozhuanlan.com/photo/2019/82509e11476d82b1379f3bf19ce9c30a.png)

- 客户端-发送一个 `FIN`，用来关闭客户端到服务器的数据传送
- 服务器-收到这个 `FIN`，它发回一 个 `ACK`，确认序号为收到的序号加1 。和 `SYN` 一样，一个 `FIN` 将占用一个序号
- 服务器-关闭与客户端的连接，发送一个 `FIN` 给客户端
- 客户端-发回 `ACK` 报文确认，并将确认序号设置为收到序号加1

举个例子：A 和 B 打电话，通话即将结束后，A 说“我没啥要说的了”，B回答“我知道了”，但是 B 可能还会有要说的话，A 不能要求 B 跟着自己的节奏结束通话，于是 B 可能又巴拉巴拉说了一通，最后 B 说“我说完了”，A 回答“知道了”，这样通话才算结束。



## 三. TCP, UDP 协议的区别

![img](https://images.xiaozhuanlan.com/photo/2019/4119f8907a61d26d24a9f610aee54b94.png)

### TCP

- 在传送数据之前必须先建立连接，数据传送结束后要释放连接。
- 不提供广播或多播服务
- 传递数据之前，会有三次握手来建立连接
- 数据传递时，有确认、窗口、重传、拥塞控制机制，在数据传完后，还会断开连接用来节约系统资源

### UDP

- UDP 在传送数据之前不需要先建立连接
- 远地主机在收到 UDP 报文后，不需要给出任何确认。

## 四. TCP 协议如何保证可靠传输

1. 应用数据被分割成 `TCP` 认为最适合发送的数据块。
2. TCP 给发送的每一个包进行编号，接收方对数据包进行排序，把有序数据传送给应用层。
3. **校验和：** `TCP` 将保持它首部和数据的检验和。这是一个端到端的检验和，目的是检测数据在传输过程中的任何变化。如果收到段的检验和有差错，TCP 将丢弃这个报文段和不确认收到此报文段。
4. TCP 的接收端会丢弃重复的数据。
5. **流量控制：** TCP 连接的每一方都有固定大小的缓冲空间，TCP的接收端只允许发送端发送接收端缓冲区能接纳的数据。当接收方来不及处理发送方的数据，能提示发送方降低发送的速率，防止包丢失。TCP 使用的流量控制协议是可变大小的滑动窗口协议。 （TCP 利用滑动窗口实现流量控制）
6. **拥塞控制：** 当网络拥塞时，减少数据的发送。
7. **ARQ协议：** 也是为了实现可靠传输的，它的基本原理就是每发完一个分组就停止发送，等待对方确认。在收到确认后再发下一个分组。
8. **超时重传：** 当 TCP 发出一个段后，它启动一个定时器，等待目的端确认收到这个报文段。如果不能及时收到一个确认，将重发这个报文段。

















































